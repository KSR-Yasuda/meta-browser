From 606fdbbf5e05ec5e6796d1c7723a714715f79770 Mon Sep 17 00:00:00 2001
From: Martin Stransky <stransky@redhat.com>
Date: Mon, 3 Apr 2017 12:10:44 +0200
Subject: [PATCH 20/44] Added --enable-wayland configure option

Signed-off-by: Hiroshi Hatake <hatake@clear-code.com>

This commit partially imports --enable-wayland configure option patch.
---
 .mozconfig            |  1 +
 toolkit/moz.configure | 14 ++++++++++++++
 2 files changed, 15 insertions(+)

diff --git a/.mozconfig b/.mozconfig
index 21497f168bc6..be9d7126606f 100644
--- a/.mozconfig
+++ b/.mozconfig
@@ -13,6 +13,7 @@ ac_add_options --without-system-nss
 
 ac_add_options --enable-debug
 ac_add_options --disable-optimize
+ac_add_options --enable-wayland
 
 ac_add_options --enable-release
 ac_add_options --disable-tests
diff --git a/toolkit/moz.configure b/toolkit/moz.configure
index 1a8c5b1bb52d..49820b7fe72f 100644
--- a/toolkit/moz.configure
+++ b/toolkit/moz.configure
@@ -194,6 +194,20 @@ set_config('MOZ_X11', x11)
 set_define('MOZ_X11', x11)
 add_old_configure_assignment('MOZ_X11', x11)
 
+# Wayland support
+# ==============================================================
+option('--enable-wayland', env='MOZ_WAYLAND',
+       help='Enable Gtk3 Wayland backend build.')
+
+@depends('--enable-wayland')
+def wayland(value):
+    if value:
+        return True
+
+set_config('MOZ_WAYLAND', wayland)
+set_define('MOZ_WAYLAND', wayland)
+imply_option('--enable-wayland', wayland)
+
 # GL Provider
 # ==============================================================
 option('--with-gl-provider', nargs=1, help='Set GL provider backend type')
-- 
2.11.0

